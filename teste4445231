def remove_duplicates_contracts(df):
    # Primeiro, identifique as linhas de 'contracts' e remova duplicados, mantendo o último
    contracts_df = df[df['type'] == 'contracts']
    contracts_last = contracts_df.drop_duplicates(subset=['register_id'], keep='last')

    # Agora, excluímos os contratos duplicados do DataFrame original
    df_without_contracts = df[df['type'] != 'contracts']

    # Junte o DataFrame sem contratos com os contratos "últimos"
    df_final = pd.concat([df_without_contracts, contracts_last])

    # Ordena pelo 'register_id' e pela 'line' para manter a sequência correta
    df_final = df_final.sort_values(by=['register_id', 'line']).reset_index(drop=True)
    
    return df_final

# Suponha que o seu DataFrame original seja 'df'
df_organizado = remove_duplicates_contracts(df)
