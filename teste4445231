def organize_files(df):
    # Primeiro, ordena pelo 'register_id' e 'line' para garantir que as linhas estejam em ordem
    df['line_order'] = df['line'].apply(lambda x: str(x) if isinstance(x, str) else str(x))
    df['line_order'] = df['line_order'].replace({
        '7': '1',  # Prioridade mais alta
        '3': '2',  # Prioridade intermediária
        'preced_1': '3'  # Menor prioridade
    })
    
    # Ordena os tipos conforme a prioridade das linhas
    df = df.sort_values(by=['register_id', 'line_order', 'type'], ascending=[True, True, True]).reset_index(drop=True)

    # Remove a coluna temporária 'line_order'
    df = df.drop(columns=['line_order'])

    return df
