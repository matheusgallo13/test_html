def organize_dataframe(df):
    # Criar prioridade baseada na ordem de aparição dos valores na coluna 'line'
    line_priority = {line: idx for idx, line in enumerate(df['line'].unique())}
    
    # Adicionando uma coluna de prioridade dinâmica
    df['priority'] = df['line'].map(line_priority)
    
    # Agrupar por 'type' e 'file' e selecionar a linha com menor prioridade
    grouped = df.groupby(['type', 'file'], group_keys=False)
    df_filtered = grouped.apply(lambda x: x.loc[x['priority'].idxmin()])
    
    # Ordenar pelo campo de prioridade e, opcionalmente, por outros campos
    df_filtered = df_filtered.sort_values(by=['priority', 'type'])
    
    # Remover a coluna auxiliar 'priority' antes de retornar
    df_filtered = df_filtered.drop(columns=['priority'])
    
    return df_filtered.reset_index(drop=True)
